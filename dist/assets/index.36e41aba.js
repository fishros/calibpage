var W=Object.defineProperty;var $=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var M=(e,u,o)=>u in e?W(e,u,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[u]=o,P=(e,u)=>{for(var o in u||(u={}))z.call(u,o)&&M(e,o,u[o]);if($)for(var o of $(u))O.call(u,o)&&M(e,o,u[o]);return e};var w=(e,u)=>{var o={};for(var l in e)z.call(e,l)&&u.indexOf(l)<0&&(o[l]=e[l]);if(e!=null&&$)for(var l of $(e))u.indexOf(l)<0&&O.call(e,l)&&(o[l]=e[l]);return o};import{l as Y,d as j,r as G,a as I,o as X,E as q,b as ee,c as ue,e as te,f as oe,g as ne,h as ae,i as se,j as re,k as le,m as x,n as r,w as c,p as S,q as E,s as B,t as y,F as ie,u as me,v as C,x as N,y as ce,z as de,A as ge,B as fe}from"./vendor.ae092d52.js";const pe=function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const m of i.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&l(m)}).observe(document,{childList:!0,subtree:!0});function o(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerpolicy&&(i.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?i.credentials="include":t.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(t){if(t.ep)return;t.ep=!0;const i=o(t);fetch(t.href,i)}};pe();const H="http://dev.nav2.fishros.com/calib",T=async(e,l={})=>{var t=l,{data:u}=t,o=w(t,["data"]);console.log(H,"apiUrl");const i=P({method:"GET"},o);return i.method.toUpperCase()==="GET"?(e+=`?${Y.stringify(u)}`,console.log("endponit",e)):i.body=JSON.stringify(u||{}),window.fetch(`${H}/${e}`,i).then(async m=>{const g=await m.json();return m.ok?g.data:Promise.reject(g)})},Fe=e=>{let u="";try{u=JSON.stringify(e)}catch(o){console.warn(o)}return u},he=e=>{let u;try{u=JSON.parse(e)}catch(o){console.warn(o)}return u},U=(e,u)=>{window.localStorage.setItem(e,Fe(u))},R=e=>{const u=window.localStorage.getItem(e);return he(u||"")},Be=()=>{var o;let e="",u="";return e=window.location.href,u=(o=e==null?void 0:e.split("?")[1])==null?void 0:o.split("=")[1],u},be=e=>{let u=new Date(e),o=u.getMonth()+1,l="-"+(o<10?"0"+o:o),t=u.getDate(),i="-"+(t<10?"0"+t:t),m=u.getHours(),g=" "+(m<10?"0"+m:m),h=u.getMinutes(),v=":"+(h<10?"0"+h:h),p=u.getSeconds(),A=":"+(p<10?"0"+p:p);return u.getFullYear()+l+i+g+v+A};var J=(e,u)=>{const o=e.__vccOpts||e;for(const[l,t]of u)o[l]=t;return o};const _e=j({name:"Home",setup(){let e;const u=G();let o=Be();const l=G(),t=I({username:"",github:"",originText:"",latestText:"",newText:"",email:""}),i=/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/,m=/^https:\/\/github.com.*$/,p=I({username:[{min:2,max:25,message:"\u6635\u79F0\u957F\u5EA6\u9700\u8981\u4E3A2\u523025\u4E4B\u95F4",trigger:"blur"}],github:[{validator:(d,s,n)=>{s===""?n(new Error("\u8BF7\u8F93\u5165\u60A8\u7684github\u4E3B\u9875\u5730\u5740")):m.test(t.github)||n(new Error("github\u4E3B\u9875\u5730\u5740\u4E0D\u6B63\u786E\uFF0C\u8BF7\u4EE5https://github.com\u5F00\u5934")),n()},required:!0,trigger:"blur"}],newText:[{validator:(d,s,n)=>{s===""?n(new Error("\u8BF7\u8F93\u5165\u60A8\u6821\u51C6\u4E4B\u540E\u7684\u5185\u5BB9")):(t.newText.trim()===t.latestText&&n(new Error("\u8BF7\u8F93\u5165\u60A8\u6821\u51C6\u4E4B\u540E\u7684\u5185\u5BB9")),n())},required:!0,trigger:"blur"}],email:[{validator:(d,s,n)=>{s===""?n(new Error("\u8BF7\u8F93\u5165\u60A8\u7684\u90AE\u7BB1\u5730\u5740")):i.test(t.email)||n(new Error("\u90AE\u7BB1\u683C\u5F0F\u4E0D\u6B63\u786E")),n()},required:!0,trigger:"blur"}]}),A=async()=>{if(o){const d=R("tw");await T("next_msg",{data:{msgid:o}}).then(s=>{var n,f,b,_;if(t.originText=(n=s[0])==null?void 0:n.msgen,t.latestText=(f=s[0])==null?void 0:f.msgzh,t.newText=(b=s[0])==null?void 0:b.msgzh,o=(_=s[0])==null?void 0:_.msgid,d){const{name:F,github:V,email:Q}=d;t.username=F,t.github=V,t.email=Q}})}},D=async()=>{const d=R("tw");await T("get_msg",{data:{msgid:o},method:"post"}).then(s=>{if(t.originText=s[0].msgen,t.latestText=s[0].msgzh,t.newText=s[0].msgzh,u.value=s[0].change_log,console.log(u,s[0].change_log),d){const{name:n,github:f,email:b}=d;t.username=n,t.github=f,t.email=b}})};return X(async()=>{o?(await D(),console.log("changeLog",u)):q.info("\u8BF7\u4ECE Nav2 \u4E2D\u6587\u7F51\u9875\u9762\u8FDB\u5165")}),{form:t,submitForm:()=>{l.value.validate(d=>{if(d){const n={calibmsg:t.newText.trim(),msgid:o,name:t.username,github:t.github,email:t.email};T("calib_msg",{data:n,method:"POST"}).then(async f=>{console.log(f,"submitForm"),E({message:`\u63D0\u4EA4\u6210\u529F\uFF0C\u68D2\u68D2\u54D2\uFF01\u606D\u559C\u60A8\u5DF2\u7D2F\u8BA1\u6821\u51C6${f.calibcount}\u8BCD\u6C47`,type:"success",duration:6e3});const V=n,{calibmsg:b,msgid:_}=V,F=w(V,["calibmsg","msgid"]);U("tw",F),await D()}).catch(f=>{E.error(f)})}else q({title:"Error",message:"\u8F93\u5165\u6709\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u60A8\u8F93\u5165\u7684\u5185\u5BB9",type:"error"})})},submitFormTitle:()=>{const s={calibmsg:t.newText.trim(),msgid:o,name:t.username,github:t.github,email:t.email,status:200};T("calib_msg",{data:s,method:"POST"}).then(n=>{console.log(n,"submitForm"),E({message:`\u63D0\u4EA4\u6210\u529F\uFF0C\u68D2\u68D2\u54D2\uFF01\u606D\u559C\u60A8\u5DF2\u7D2F\u8BA1\u6821\u51C6${n.calibcount}\u8BCD\u6C47`,type:"success",duration:6e3});const F=s,{calibmsg:f,msgid:b}=F,_=w(F,["calibmsg","msgid"]);U("tw",_)}).catch(n=>{E.error(n)})},submitFormUnTrans:()=>{const s={calibmsg:t.newText.trim(),msgid:o,name:t.username,github:t.github,email:t.email,status:201};T("calib_msg",{data:s,method:"POST"}).then(n=>{console.log(n.calibcount,"submitForm"),E({message:`\u63D0\u4EA4\u6210\u529F\uFF0C\u68D2\u68D2\u54D2\uFF01\u606D\u559C\u60A8\u5DF2\u7D2F\u8BA1\u6821\u51C6${n.calibcount}\u8BCD\u6C47`,type:"success",duration:6e3});const F=s,{calibmsg:f,msgid:b}=F,_=w(F,["calibmsg","msgid"]);U("tw",_)}).catch(n=>{E.error(n)})},data:e,rules:p,getNextMsg:A,formRef:l,changeLog:u,formatGMT:be}}}),Ee={class:"container"},ye=B("h2",{class:"title"}," \u5F00\u6E90\u4E92\u52A9 \u5171\u540C\u8FDB\u6B65 \u611F\u8C22\u60A8\u7684\u6821\u6B63 ",-1),Ae={class:"btns"},we=C("\u6807\u8BB0\u6807\u9898"),Ce=C("\u6807\u8BB0\u65E0\u9700\u7FFB\u8BD1"),Te=C("\u63D0\u4EA4"),ve=C("\u4E0B\u4E00\u6761"),De=B("h3",{class:"logTitle"},"\u6821\u51C6\u66F4\u65B0\u8BB0\u5F55\uFF1A",-1),Ve={class:"calibmsg-title"},$e=["href"],xe={key:1};function Se(e,u,o,l,t,i){const m=ee,g=ue,h=te,v=oe,p=ne,A=ae,D=se,k=re,L=le;return y(),x("div",Ee,[ye,r(A,{ref:"formRef",model:e.form,"label-width":"auto",rules:e.rules},{default:c(()=>[r(v,{justify:"center",align:"center"},{default:c(()=>[r(h,{span:8},{default:c(()=>[r(g,{label:"\u6635\u79F0\uFF1A",prop:"username"},{default:c(()=>[r(m,{modelValue:e.form.username,"onUpdate:modelValue":u[0]||(u[0]=a=>e.form.username=a),placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u6635\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),r(h,{span:8},{default:c(()=>[r(g,{label:"github\u4E3B\u9875\uFF1A",prop:"github"},{default:c(()=>[r(m,{modelValue:e.form.github,"onUpdate:modelValue":u[1]||(u[1]=a=>e.form.github=a),placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684github\u4E3B\u9875\u5730\u5740"},null,8,["modelValue"])]),_:1})]),_:1}),r(h,{span:8},{default:c(()=>[r(g,{label:"\u90AE\u7BB1\uFF1A",prop:"email"},{default:c(()=>[r(m,{modelValue:e.form.email,"onUpdate:modelValue":u[2]||(u[2]=a=>e.form.email=a),placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u90AE\u7BB1\u5730\u5740"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),r(g,{label:"\u539F\u6587\u5185\u5BB9\uFF1A"},{default:c(()=>[r(m,{modelValue:e.form.originText,"onUpdate:modelValue":u[3]||(u[3]=a=>e.form.originText=a),type:"textarea",readonly:"",autosize:""},null,8,["modelValue"])]),_:1}),r(g,{label:"\u4E0A\u4E00\u7248\u672C\u7FFB\u8BD1\u5185\u5BB9\uFF1A"},{default:c(()=>[r(m,{modelValue:e.form.latestText,"onUpdate:modelValue":u[4]||(u[4]=a=>e.form.latestText=a),type:"textarea",autosize:"",readonly:""},null,8,["modelValue"])]),_:1}),r(g,{label:"\u65B0\u7684\u7FFB\u8BD1\u5185\u5BB9\uFF1A",prop:"newText"},{default:c(()=>[r(m,{modelValue:e.form.newText,"onUpdate:modelValue":u[5]||(u[5]=a=>e.form.newText=a),type:"textarea",autosize:"",placeholder:"\u8BF7\u8F93\u5165\u60A8\u6821\u51C6\u4E4B\u540E\u7684\u5185\u5BB9"},null,8,["modelValue"])]),_:1}),r(g,null,{default:c(()=>[B("div",Ae,[B("div",null,[r(p,{type:"primary",onClick:e.submitFormTitle},{default:c(()=>[we]),_:1},8,["onClick"]),r(p,{type:"primary",onClick:e.submitFormUnTrans},{default:c(()=>[Ce]),_:1},8,["onClick"])]),B("div",null,[r(p,{type:"primary",onClick:e.submitForm},{default:c(()=>[Te]),_:1},8,["onClick"]),r(p,{type:"primary",onClick:e.getNextMsg},{default:c(()=>[ve]),_:1},8,["onClick"])])])]),_:1})]),_:1},8,["model","rules"]),De,e.changeLog.length>0?(y(),S(L,{key:0},{default:c(()=>[(y(!0),x(ie,null,me(e.changeLog,(a,d)=>(y(),S(k,{placement:"top",key:d,timestamp:e.formatGMT(a==null?void 0:a.update_time)},{default:c(()=>[r(D,null,{default:c(()=>[B("h4",Ve,[B("a",{href:a==null?void 0:a.github,target:"_blank"},N(a==null?void 0:a.contributor),9,$e),C(" \u6821\u51C6\u4E8E "+N(e.formatGMT(a==null?void 0:a.update_time)),1)]),B("p",null,N(a==null?void 0:a.calibmsg),1)]),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1})):(y(),x("p",xe,"\u5F53\u524D\u6682\u65E0\u6821\u51C6\u5185\u5BB9\uFF0C\u5FEB\u6765\u6821\u51C6\u5427~"))])}var Z=J(_e,[["render",Se]]);const Ne=j({components:{Home:Z},name:"App",setup(){return{}}});function Ue(e,u,o,l,t,i){const m=ce("home");return y(),S(m)}var ke=J(Ne,[["render",Ue]]);const Le=[{path:"/",redirect:"/home"},{path:"/home/:msgid",name:"Home",component:Z}],ze=de({history:ge(),routes:Le}),K=fe(ke);K.use(ze);K.mount("#app");
