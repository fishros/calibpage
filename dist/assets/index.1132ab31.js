var ee=Object.defineProperty;var k=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var I=(e,t,a)=>t in e?ee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,P=(e,t)=>{for(var a in t||(t={}))O.call(t,a)&&I(e,a,t[a]);if(k)for(var a of k(t))G.call(t,a)&&I(e,a,t[a]);return e};var $=(e,t)=>{var a={};for(var d in e)O.call(e,d)&&t.indexOf(d)<0&&(a[d]=e[d]);if(e!=null&&k)for(var d of k(e))t.indexOf(d)<0&&G.call(e,d)&&(a[d]=e[d]);return a};import{l as te,d as j,r as S,a as H,o as ue,E as q,b as oe,c as ae,e as ne,f as le,g as se,h as re,i as ie,j as me,k as de,m as ce,n as ge,p as pe,q as fe,s as Fe,t as N,w as r,u as x,v as b,x as l,y as f,z as R,A as he,F as _e,B as z,C as B,D as be,G as Be,H as Ee,I as ye}from"./vendor.85dd4959.js";const we=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))d(n);new MutationObserver(n=>{for(const m of n)if(m.type==="childList")for(const o of m.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&d(o)}).observe(document,{childList:!0,subtree:!0});function a(n){const m={};return n.integrity&&(m.integrity=n.integrity),n.referrerpolicy&&(m.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?m.credentials="include":n.crossorigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function d(n){if(n.ep)return;n.ep=!0;const m=a(n);fetch(n.href,m)}};we();const W="http://dev.nav2.fishros.com/calib",w=async(e,d={})=>{var n=d,{data:t}=n,a=$(n,["data"]);console.log(W,"apiUrl");const m=P({method:"GET"},a);return m.method.toUpperCase()==="GET"?(e+=`?${te.stringify(t)}`,console.log("endponit",e)):m.body=JSON.stringify(t||{}),window.fetch(`${W}/${e}`,m).then(async o=>{const c=await o.json();return o.ok?c.data:Promise.reject(c)})},Ce=e=>{let t="";try{t=JSON.stringify(e)}catch(a){console.warn(a)}return t},ve=e=>{let t;try{t=JSON.parse(e)}catch(a){console.warn(a)}return t},J=(e,t)=>{window.localStorage.setItem(e,Ce(t))},Z=e=>{const t=window.localStorage.getItem(e);return ve(t||"")},Ae=()=>{var a;let e="",t="";return e=window.location.href,t=(a=e==null?void 0:e.split("?")[1])==null?void 0:a.split("=")[1],t},Te=e=>{let t=new Date(e),a=t.getMonth()+1,d="-"+(a<10?"0"+a:a),n=t.getDate(),m="-"+(n<10?"0"+n:n),o=t.getHours(),c=" "+(o<10?"0"+o:o),F=t.getMinutes(),C=":"+(F<10?"0"+F:F),p=t.getSeconds(),v=":"+(p<10?"0"+p:p);return t.getFullYear()+d+m+c+C+v};var K=(e,t)=>{const a=e.__vccOpts||e;for(const[d,n]of t)a[d]=n;return a};const De=j({name:"Home",setup(){let e,t=S();const a=S(),d=S("calibpage");let n=Ae();const m=S(),o=H({username:"",github:"",originText:"",latestText:"",newText:"",email:""}),c=/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/,F=/^https:\/\/github.com.*$/,L=H({username:[{min:2,max:25,message:"\u6635\u79F0\u957F\u5EA6\u9700\u8981\u4E3A2\u523025\u4E4B\u95F4",trigger:"blur"}],github:[{validator:(s,u,i)=>{u===""?i(new Error("\u8BF7\u8F93\u5165\u60A8\u7684github\u4E3B\u9875\u5730\u5740")):F.test(o.github)||i(new Error("github\u4E3B\u9875\u5730\u5740\u4E0D\u6B63\u786E\uFF0C\u8BF7\u4EE5https://github.com\u5F00\u5934")),i()},required:!0,trigger:"blur"}],newText:[{validator:(s,u,i)=>{u===""?i(new Error("\u8BF7\u8F93\u5165\u60A8\u6821\u51C6\u4E4B\u540E\u7684\u5185\u5BB9")):(o.newText.trim()===o.latestText&&i(new Error("\u8BF7\u8F93\u5165\u60A8\u6821\u51C6\u4E4B\u540E\u7684\u5185\u5BB9")),i())},required:!0,trigger:"blur"}],email:[{validator:(s,u,i)=>{u===""?i(new Error("\u8BF7\u8F93\u5165\u60A8\u7684\u90AE\u7BB1\u5730\u5740")):c.test(o.email)||i(new Error("\u90AE\u7BB1\u683C\u5F0F\u4E0D\u6B63\u786E")),i()},required:!0,trigger:"blur"}]}),M=async()=>{if(n){const s=Z("tw");await w("next_msg",{data:{msgid:n}}).then(u=>{var i,g,_,V;if(o.originText=(i=u[0])==null?void 0:i.msgen,o.latestText=(g=u[0])==null?void 0:g.msgzh,o.newText=(_=u[0])==null?void 0:_.msgzh,n=(V=u[0])==null?void 0:V.msgid,s){const{name:y,github:h,email:X}=s;o.username=y,o.github=h,o.email=X}})}},A=async()=>{const s=Z("tw");await w("get_msg",{data:{msgid:n},method:"post"}).then(u=>{if(o.originText=u[0].msgen,o.latestText=u[0].msgzh,o.newText=u[0].msgzh,a.value=u[0].change_log,s){const{name:i,github:g,email:_}=s;o.username=i,o.github=g,o.email=_}})};ue(async()=>{n?(await A(),await D()):q.info("\u8BF7\u4ECE\u4E2D\u6587\u7F51\u9875\u9762\u8FDB\u5165")}),oe(async()=>{await D()});const T=()=>{m.value.validate(s=>{if(s){const i={calibmsg:o.newText.trim(),msgid:n,name:o.username,github:o.github,email:o.email};w("calib_msg",{data:i,method:"POST"}).then(async g=>{x({message:`\u63D0\u4EA4\u6210\u529F\uFF0C\u68D2\u68D2\u54D2\uFF01\u606D\u559C\u60A8\u5DF2\u7D2F\u8BA1\u6821\u51C6${g.calibcount}\u8BCD\u6C47`,type:"success",duration:6e3});const h=i,{calibmsg:_,msgid:V}=h,y=$(h,["calibmsg","msgid"]);J("tw",y),await A()}).catch(g=>{x.error(g)})}else q({title:"Error",message:"\u8F93\u5165\u6709\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u60A8\u8F93\u5165\u7684\u5185\u5BB9",type:"error"})})},E=s=>{const i={calibmsg:o.newText.trim(),msgid:n,name:o.username,github:o.github,email:o.email,status:s};w("calib_msg",{data:i,method:"POST"}).then(g=>{x({message:`\u63D0\u4EA4\u6210\u529F\uFF0C\u68D2\u68D2\u54D2\uFF01\u606D\u559C\u60A8\u5DF2\u7D2F\u8BA1\u6821\u51C6${g.calibcount}\u8BCD\u6C47`,type:"success",duration:6e3});const h=i,{calibmsg:_,msgid:V}=h,y=$(h,["calibmsg","msgid"]);J("tw",y)}).catch(g=>{x.error(g)})},U=(s,u)=>{console.log(s,u)},D=()=>{w("calib_rank").then(s=>{console.log(s,"rankres"),t.value=s,console.log(t.value,"rankData")})};return{form:o,submitForm:T,submitFormWithStatus:E,data:e,rules:L,getNextMsg:M,formRef:m,changeLog:a,formatGMT:Te,handleClickTab:U,rankData:t,activeName:d}}}),Ve={class:"container"},ke=f("h2",{class:"title"},"\u5F00\u6E90\u4E92\u52A9\uFF0C\u5171\u540C\u63D0\u9AD8",-1),$e={class:"btns"},Se=B("\u6807\u8BB0\u6807\u9898"),Ne=B("\u6807\u8BB0\u65E0\u9700\u7FFB\u8BD1"),xe=B("\u6807\u8BB0\u65E0\u9700\u6821\u51C6"),ze=B("\u63D0\u4EA4"),Le=B("\u4E0B\u4E00\u6761"),Me=f("h3",{class:"logTitle"},"\u6821\u51C6\u66F4\u65B0\u8BB0\u5F55\uFF1A",-1),Ue={class:"calibmsg-title"},Oe=["href"],Ge={key:1},Ie=["href"];function Pe(e,t,a,d,n,m){const o=ae,c=ne,F=le,C=se,p=re,v=ie,L=me,M=de,A=ce,T=ge,E=pe,U=fe,D=Fe;return b(),N(D,{modelValue:e.activeName,"onUpdate:modelValue":t[9]||(t[9]=s=>e.activeName=s),onTabClick:e.handleClickTab,value:""},{default:r(()=>[l(T,{label:"\u6821\u51C6\u9875",name:"calibpage"},{default:r(()=>{var s;return[f("div",Ve,[ke,l(v,{ref:"formRef",model:e.form,"label-width":"auto",rules:e.rules},{default:r(()=>[l(C,{justify:"center",align:"center"},{default:r(()=>[l(F,{span:8},{default:r(()=>[l(c,{label:"\u6635\u79F0\uFF1A",prop:"username"},{default:r(()=>[l(o,{modelValue:e.form.username,"onUpdate:modelValue":t[0]||(t[0]=u=>e.form.username=u),placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u6635\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),l(F,{span:8},{default:r(()=>[l(c,{label:"github\u4E3B\u9875\uFF1A",prop:"github"},{default:r(()=>[l(o,{modelValue:e.form.github,"onUpdate:modelValue":t[1]||(t[1]=u=>e.form.github=u),placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684github\u4E3B\u9875\u5730\u5740"},null,8,["modelValue"])]),_:1})]),_:1}),l(F,{span:8},{default:r(()=>[l(c,{label:"\u90AE\u7BB1\uFF1A",prop:"email"},{default:r(()=>[l(o,{modelValue:e.form.email,"onUpdate:modelValue":t[2]||(t[2]=u=>e.form.email=u),placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u90AE\u7BB1\u5730\u5740"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(c,{label:"\u539F\u6587\u5185\u5BB9\uFF1A"},{default:r(()=>[l(o,{modelValue:e.form.originText,"onUpdate:modelValue":t[3]||(t[3]=u=>e.form.originText=u),type:"textarea",readonly:"",autosize:""},null,8,["modelValue"])]),_:1}),l(c,{label:"\u4E0A\u4E00\u7248\u672C\u7FFB\u8BD1\u5185\u5BB9\uFF1A"},{default:r(()=>[l(o,{modelValue:e.form.latestText,"onUpdate:modelValue":t[4]||(t[4]=u=>e.form.latestText=u),type:"textarea",autosize:"",readonly:""},null,8,["modelValue"])]),_:1}),l(c,{label:"\u65B0\u7684\u7FFB\u8BD1\u5185\u5BB9\uFF1A",prop:"newText"},{default:r(()=>[l(o,{modelValue:e.form.newText,"onUpdate:modelValue":t[5]||(t[5]=u=>e.form.newText=u),type:"textarea",autosize:"",placeholder:"\u8BF7\u8F93\u5165\u60A8\u6821\u51C6\u4E4B\u540E\u7684\u5185\u5BB9"},null,8,["modelValue"])]),_:1}),l(c,null,{default:r(()=>[f("div",$e,[f("div",null,[l(p,{type:"primary",onClick:t[6]||(t[6]=u=>e.submitFormWithStatus(200))},{default:r(()=>[Se]),_:1}),l(p,{type:"primary",onClick:t[7]||(t[7]=u=>e.submitFormWithStatus(201))},{default:r(()=>[Ne]),_:1}),l(p,{type:"primary",onClick:t[8]||(t[8]=u=>e.submitFormWithStatus(202))},{default:r(()=>[xe]),_:1})]),f("div",null,[l(p,{type:"primary",onClick:e.submitForm},{default:r(()=>[ze]),_:1},8,["onClick"]),l(p,{type:"primary",onClick:e.getNextMsg},{default:r(()=>[Le]),_:1},8,["onClick"])])])]),_:1})]),_:1},8,["model","rules"]),Me,((s=e.changeLog)==null?void 0:s.length)>0?(b(),N(A,{key:0},{default:r(()=>[(b(!0),R(_e,null,he(e.changeLog,(u,i)=>(b(),N(M,{placement:"top",key:i,timestamp:e.formatGMT(u==null?void 0:u.update_time)},{default:r(()=>[l(L,null,{default:r(()=>[f("h4",Ue,[f("a",{href:u==null?void 0:u.github,target:"_blank"},z(u==null?void 0:u.contributor),9,Oe),B(" \u66F4\u65B0\u4E8E "+z(e.formatGMT(u==null?void 0:u.update_time)),1)]),f("p",null,z(u==null?void 0:u.calibmsg),1)]),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1})):(b(),R("p",Ge,"\u5F53\u524D\u6682\u65E0\u6821\u51C6\u5185\u5BB9\uFF0C\u5FEB\u6765\u6821\u51C6\u5427~"))])]}),_:1}),l(T,{label:"\u6392\u884C\u699C",name:"rank"},{default:r(()=>[l(U,{data:e.rankData,style:{width:"70%"},"header-cell-style":{"text-align":"center",color:"#333"},border:""},{default:r(()=>[l(E,{type:"index",label:"\u6392\u540D",align:"center",width:"180"}),l(E,{prop:"name",label:"\u8D21\u732E\u8005\u540D\u79F0",align:"center"},{default:r(s=>[f("a",{href:s.row.github},z(s.row.name),9,Ie)]),_:1}),l(E,{prop:"p_count",label:"\u6821\u51C6\u6BB5\u843D\u603B\u8BA1",align:"center"})]),_:1},8,["data"])]),_:1})]),_:1},8,["modelValue","onTabClick"])}var Q=K(De,[["render",Pe]]);const je=j({components:{Home:Q},name:"App",setup(){return{}}});function He(e,t,a,d,n,m){const o=be("home");return b(),N(o)}var qe=K(je,[["render",He]]);const Re=[{path:"/",redirect:"/home"},{path:"/home/:msgid",name:"Home",component:Q}],We=Be({history:Ee(),routes:Re}),Y=ye(qe);Y.use(We);Y.mount("#app");
