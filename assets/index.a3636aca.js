var X=Object.defineProperty;var D=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var G=(e,t,a)=>t in e?X(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,I=(e,t)=>{for(var a in t||(t={}))U.call(t,a)&&G(e,a,t[a]);if(D)for(var a of D(t))O.call(t,a)&&G(e,a,t[a]);return e};var V=(e,t)=>{var a={};for(var d in e)U.call(e,d)&&t.indexOf(d)<0&&(a[d]=e[d]);if(e!=null&&D)for(var d of D(e))t.indexOf(d)<0&&O.call(e,d)&&(a[d]=e[d]);return a};import{l as ee,d as P,r as k,a as j,o as te,E as H,b as ue,c as oe,e as ae,f as ne,g as le,h as re,i as se,j as ie,k as me,m as de,n as ce,p as ge,q as pe,s as fe,t as $,w as s,u as S,v as h,x as l,y as f,z as q,A as Fe,F as he,B as N,C as _,D as _e,G as be,H as Be,I as Ee}from"./vendor.a7ce4016.js";const ye=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))d(n);new MutationObserver(n=>{for(const m of n)if(m.type==="childList")for(const o of m.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&d(o)}).observe(document,{childList:!0,subtree:!0});function a(n){const m={};return n.integrity&&(m.integrity=n.integrity),n.referrerpolicy&&(m.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?m.credentials="include":n.crossorigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function d(n){if(n.ep)return;n.ep=!0;const m=a(n);fetch(n.href,m)}};ye();const R="http://fishros.org:2023/ros2/calib",y=async(e,d={})=>{var n=d,{data:t}=n,a=V(n,["data"]);console.log(R,"apiUrl");const m=I({method:"GET"},a);return m.method.toUpperCase()==="GET"?(e+=`?${ee.stringify(t)}`,console.log("endponit",e)):m.body=JSON.stringify(t||{}),window.fetch(`${R}/${e}`,m).then(async o=>{const c=await o.json();return o.ok?c.data:Promise.reject(c)})},we=e=>{let t="";try{t=JSON.stringify(e)}catch(a){console.warn(a)}return t},Ce=e=>{let t;try{t=JSON.parse(e)}catch(a){console.warn(a)}return t},W=(e,t)=>{window.localStorage.setItem(e,we(t))},J=e=>{const t=window.localStorage.getItem(e);return Ce(t||"")},Ae=()=>{var a;let e="",t="";return e=window.location.href,t=(a=e==null?void 0:e.split("?")[1])==null?void 0:a.split("=")[1],t},ve=e=>{let t=new Date(e),a=t.getMonth()+1,d="-"+(a<10?"0"+a:a),n=t.getDate(),m="-"+(n<10?"0"+n:n),o=t.getHours(),c=" "+(o<10?"0"+o:o),F=t.getMinutes(),w=":"+(F<10?"0"+F:F),p=t.getSeconds(),C=":"+(p<10?"0"+p:p);return t.getFullYear()+d+m+c+w+C};var Z=(e,t)=>{const a=e.__vccOpts||e;for(const[d,n]of t)a[d]=n;return a};const Te=P({name:"Home",setup(){let e,t=k();const a=k(),d=k("calibpage");let n=Ae();const m=k(),o=j({username:"",github:"",originText:"",latestText:"",newText:"",email:""}),c=/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/,F=/^https:\/\/github.com.*$/,x=j({username:[{min:2,max:25,message:"\u6635\u79F0\u957F\u5EA6\u9700\u8981\u4E3A2\u523025\u4E4B\u95F4",trigger:"blur"}],github:[{validator:(r,u,i)=>{u===""?i(new Error("\u8BF7\u8F93\u5165\u60A8\u7684github\u4E3B\u9875\u5730\u5740")):F.test(o.github)||i(new Error("github\u4E3B\u9875\u5730\u5740\u4E0D\u6B63\u786E\uFF0C\u8BF7\u4EE5https://github.com\u5F00\u5934")),i()},required:!0,trigger:"blur"}],newText:[{validator:(r,u,i)=>{u===""?i(new Error("\u8BF7\u8F93\u5165\u60A8\u6821\u51C6\u4E4B\u540E\u7684\u5185\u5BB9")):(o.newText.trim()===o.latestText&&i(new Error("\u8BF7\u8F93\u5165\u60A8\u6821\u51C6\u4E4B\u540E\u7684\u5185\u5BB9")),i())},required:!0,trigger:"blur"}],email:[{validator:(r,u,i)=>{u===""?i(new Error("\u8BF7\u8F93\u5165\u60A8\u7684\u90AE\u7BB1\u5730\u5740")):c.test(o.email)||i(new Error("\u90AE\u7BB1\u683C\u5F0F\u4E0D\u6B63\u786E")),i()},required:!0,trigger:"blur"}]}),z=async()=>{if(n){const r=J("tw");await y("next_msg",{data:{msgid:n}}).then(u=>{if(o.originText=u==null?void 0:u.msgen,o.latestText=u==null?void 0:u.msgzh,o.newText=u==null?void 0:u.msgzh,n=u==null?void 0:u.msgid,r){const{name:i,github:g,email:B}=r;o.username=i,o.github=g,o.email=B}})}},A=async()=>{const r=J("tw");await y("get_msg",{data:{msgid:n},method:"post"}).then(u=>{if(o.originText=u.msgen,o.latestText=u.msgzh,o.newText=u.msgzh,a.value=u.change_log,r){const{name:i,github:g,email:B}=r;o.username=i,o.github=g,o.email=B}})};te(async()=>{n?(await A(),await T()):H.info("\u8BF7\u4ECE\u4E2D\u6587\u7F51\u9875\u9762\u8FDB\u5165")}),ue(async()=>{await T()});const v=()=>{m.value.validate(r=>{if(r){const i={calibmsg:o.newText.trim(),msgid:n,name:o.username,github:o.github,email:o.email};y("calib_msg",{data:i,method:"POST"}).then(async g=>{S({message:`\u63D0\u4EA4\u6210\u529F\uFF0C\u68D2\u68D2\u54D2\uFF01\u606D\u559C\u60A8\u5DF2\u7D2F\u8BA1\u6821\u51C6${g.calibcount}\u8BCD\u6C47`,type:"success",duration:6e3});const E=i,{calibmsg:B,msgid:Y}=E,M=V(E,["calibmsg","msgid"]);W("tw",M),await A()}).catch(g=>{S.error(g)})}else H({title:"Error",message:"\u8F93\u5165\u6709\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u60A8\u8F93\u5165\u7684\u5185\u5BB9",type:"error"})})},b=r=>{const i={calibmsg:o.newText.trim(),msgid:n,name:o.username,github:o.github,email:o.email,status:r};y("calib_msg",{data:i,method:"POST"}).then(g=>{S({message:`\u63D0\u4EA4\u6210\u529F\uFF0C\u68D2\u68D2\u54D2\uFF01\u606D\u559C\u60A8\u5DF2\u7D2F\u8BA1\u6821\u51C6${g.calibcount}\u8BCD\u6C47`,type:"success",duration:6e3});const E=i,{calibmsg:B,msgid:Y}=E,M=V(E,["calibmsg","msgid"]);W("tw",M)}).catch(g=>{S.error(g)})},L=(r,u)=>{console.log(r,u)},T=()=>{y("calib_rank").then(r=>{console.log(r,"rankres"),t.value=r,console.log(t.value,"rankData")})};return{form:o,submitForm:v,submitFormWithStatus:b,data:e,rules:x,getNextMsg:z,formRef:m,changeLog:a,formatGMT:ve,handleClickTab:L,rankData:t,activeName:d}}}),De={class:"container"},Ve=f("h2",{class:"title"},"\u5F00\u6E90\u4E92\u52A9\uFF0C\u5171\u540C\u63D0\u9AD8",-1),ke={class:"btns"},$e=_("\u6807\u8BB0\u6807\u9898"),Se=_("\u6807\u8BB0\u65E0\u9700\u7FFB\u8BD1"),Ne=_("\u6807\u8BB0\u65E0\u9700\u6821\u51C6"),xe=_("\u63D0\u4EA4"),ze=_("\u4E0B\u4E00\u6761"),Le=f("h3",{class:"logTitle"},"\u6821\u51C6\u66F4\u65B0\u8BB0\u5F55\uFF1A",-1),Me={class:"calibmsg-title"},Ue=["href"],Oe={key:1},Ge=["href"];function Ie(e,t,a,d,n,m){const o=oe,c=ae,F=ne,w=le,p=re,C=se,x=ie,z=me,A=de,v=ce,b=ge,L=pe,T=fe;return h(),$(T,{modelValue:e.activeName,"onUpdate:modelValue":t[9]||(t[9]=r=>e.activeName=r),onTabClick:e.handleClickTab,value:""},{default:s(()=>[l(v,{label:"\u6821\u51C6\u9875",name:"calibpage"},{default:s(()=>{var r;return[f("div",De,[Ve,l(C,{ref:"formRef",model:e.form,"label-width":"auto",rules:e.rules},{default:s(()=>[l(w,{justify:"center",align:"center"},{default:s(()=>[l(F,{span:8},{default:s(()=>[l(c,{label:"\u6635\u79F0\uFF1A",prop:"username"},{default:s(()=>[l(o,{modelValue:e.form.username,"onUpdate:modelValue":t[0]||(t[0]=u=>e.form.username=u),placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u6635\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),l(F,{span:8},{default:s(()=>[l(c,{label:"github\u4E3B\u9875\uFF1A",prop:"github"},{default:s(()=>[l(o,{modelValue:e.form.github,"onUpdate:modelValue":t[1]||(t[1]=u=>e.form.github=u),placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684github\u4E3B\u9875\u5730\u5740"},null,8,["modelValue"])]),_:1})]),_:1}),l(F,{span:8},{default:s(()=>[l(c,{label:"\u90AE\u7BB1\uFF1A",prop:"email"},{default:s(()=>[l(o,{modelValue:e.form.email,"onUpdate:modelValue":t[2]||(t[2]=u=>e.form.email=u),placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u90AE\u7BB1\u5730\u5740"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(c,{label:"\u539F\u6587\u5185\u5BB9\uFF1A"},{default:s(()=>[l(o,{modelValue:e.form.originText,"onUpdate:modelValue":t[3]||(t[3]=u=>e.form.originText=u),type:"textarea",readonly:"",autosize:""},null,8,["modelValue"])]),_:1}),l(c,{label:"\u4E0A\u4E00\u7248\u672C\u7FFB\u8BD1\u5185\u5BB9\uFF1A"},{default:s(()=>[l(o,{modelValue:e.form.latestText,"onUpdate:modelValue":t[4]||(t[4]=u=>e.form.latestText=u),type:"textarea",autosize:"",readonly:""},null,8,["modelValue"])]),_:1}),l(c,{label:"\u65B0\u7684\u7FFB\u8BD1\u5185\u5BB9\uFF1A",prop:"newText"},{default:s(()=>[l(o,{modelValue:e.form.newText,"onUpdate:modelValue":t[5]||(t[5]=u=>e.form.newText=u),type:"textarea",autosize:"",placeholder:"\u8BF7\u8F93\u5165\u60A8\u6821\u51C6\u4E4B\u540E\u7684\u5185\u5BB9"},null,8,["modelValue"])]),_:1}),l(c,null,{default:s(()=>[f("div",ke,[f("div",null,[l(p,{type:"primary",onClick:t[6]||(t[6]=u=>e.submitFormWithStatus(200))},{default:s(()=>[$e]),_:1}),l(p,{type:"primary",onClick:t[7]||(t[7]=u=>e.submitFormWithStatus(201))},{default:s(()=>[Se]),_:1}),l(p,{type:"primary",onClick:t[8]||(t[8]=u=>e.submitFormWithStatus(202))},{default:s(()=>[Ne]),_:1})]),f("div",null,[l(p,{type:"primary",onClick:e.submitForm},{default:s(()=>[xe]),_:1},8,["onClick"]),l(p,{type:"primary",onClick:e.getNextMsg},{default:s(()=>[ze]),_:1},8,["onClick"])])])]),_:1})]),_:1},8,["model","rules"]),Le,((r=e.changeLog)==null?void 0:r.length)>0?(h(),$(A,{key:0},{default:s(()=>[(h(!0),q(he,null,Fe(e.changeLog,(u,i)=>(h(),$(z,{placement:"top",key:i,timestamp:e.formatGMT(u==null?void 0:u.update_time)},{default:s(()=>[l(x,null,{default:s(()=>[f("h4",Me,[f("a",{href:u==null?void 0:u.github,target:"_blank"},N(u==null?void 0:u.contributor),9,Ue),_(" \u66F4\u65B0\u4E8E "+N(e.formatGMT(u==null?void 0:u.update_time)),1)]),f("p",null,N(u==null?void 0:u.calibmsg),1)]),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1})):(h(),q("p",Oe,"\u5F53\u524D\u6682\u65E0\u6821\u51C6\u5185\u5BB9\uFF0C\u5FEB\u6765\u6821\u51C6\u5427~"))])]}),_:1}),l(v,{label:"\u6392\u884C\u699C",name:"rank"},{default:s(()=>[l(L,{data:e.rankData,style:{width:"70%"},"header-cell-style":{"text-align":"center",color:"#333"},border:""},{default:s(()=>[l(b,{type:"index",label:"\u6392\u540D",align:"center",width:"180"}),l(b,{prop:"name",label:"\u8D21\u732E\u8005\u540D\u79F0",align:"center"},{default:s(r=>[f("a",{href:r.row.github},N(r.row.name),9,Ge)]),_:1}),l(b,{prop:"p_count",label:"\u6821\u51C6\u6BB5\u843D\u603B\u8BA1",align:"center"})]),_:1},8,["data"])]),_:1})]),_:1},8,["modelValue","onTabClick"])}var K=Z(Te,[["render",Ie]]);const Pe=P({components:{Home:K},name:"App",setup(){return{}}});function je(e,t,a,d,n,m){const o=_e("home");return h(),$(o)}var He=Z(Pe,[["render",je]]);const qe=[{path:"/",redirect:"/home"},{path:"/home/:msgid",name:"Home",component:K}],Re=be({history:Be(),routes:qe}),Q=Ee(He);Q.use(Re);Q.mount("#app");
